# LinchKit 当前任务和优先级

**最后更新**: 2025-06-21 21:30
**文档职责**: 记录当前正在执行的具体任务和下一步行动计划
**与 development-plan.md 的区别**: 本文档关注当前任务执行，development-plan.md 关注整体规划

## 🎯 当前最高优先级任务

### P0: UI 包核心改进 - Schema 驱动的深度集成
**状态**: 🔄 立即开始
**预计时间**: 2-3 天
**负责**: AI Assistant
**完成度**: 30% (基础架构已完成)

#### 背景
基于已完成的统一国际化架构和第三方组件封装优化，继续完善 LinchKit UI 组件库的 Schema 驱动集成。当前 `packages/ui/src/schema/index.ts` 已有基础实现，需要完善和扩展。

#### 详细实施计划

**第一阶段: Schema 驱动的高级筛选** (1 天)
- [ ] 创建 `packages/ui/src/schema/filter-generator.ts`
  - 基于字段类型自动生成筛选组件
  - 支持文本、数字、日期、枚举等类型筛选
  - 实现复合筛选条件构建器
- [ ] 扩展 DataTable 组件集成筛选功能
  - 在 `packages/ui/src/components/data-table/` 中添加筛选支持
  - 实现筛选状态管理和 URL 同步
- [ ] 创建筛选组件库
  - 创建 `packages/ui/src/components/filters/` 目录
  - 实现 TextFilter, NumberFilter, DateFilter, SelectFilter 等组件

**第二阶段: Schema 驱动的表单生成** (1 天)
- [ ] 完善 `packages/ui/src/schema/form-generator.ts`
  - 扩展 FormBuilder 组件支持 Schema 自动生成
  - 实现字段类型到 UI 组件的自动映射
  - 支持嵌套对象和数组字段
- [ ] 增强表单验证和错误处理
  - 集成 Zod 验证错误显示
  - 添加国际化错误消息
- [ ] 创建表单字段组件库
  - 在 `packages/ui/src/components/form-fields/` 中添加各种字段类型

**第三阶段: 类型安全和验证** (0.5 天)
- [ ] 完善 Schema 到 UI 组件的类型推断
- [ ] 确保端到端类型安全
- [ ] 添加 TypeScript 类型测试
- [ ] 在 linch-starter 中验证功能

**第四阶段: 文档和示例** (0.5 天)
- [ ] 更新 DataTable 高级用法文档
- [ ] 添加 Schema 驱动开发示例
- [ ] 在 `apps/linch-starter` 中验证功能
- [ ] 创建完整的使用教程

#### 需要同步更新的包
- **@linch-kit/schema**: 扩展 UI 配置类型定义
- **@linch-kit/types**: 添加 UI 相关的共享类型
- **apps/linch-starter**: 验证新功能

## ✅ 最近完成的任务

### 国际化架构重构、包管理优化和安全性修复
**完成时间**: 2025-06-21 18:00
**状态**: ✅ 已完成

#### 关键成果
1. ✅ **安全修复**: 移除硬编码敏感信息 + pre-commit hook 检查
2. ✅ **统一 i18n**: @linch-kit/core 统一架构 + 所有包重构
3. ✅ **包重命名**: @linch-kit/auth-core → @linch-kit/auth
4. ✅ **脚本优化**: TypeScript 重构 + 冗余清理
5. ✅ **文档整合**: prompts 合并到 ai-context

### DataTable 组件优化 - 第三方组件封装策略
**完成时间**: 2025-06-21 17:30
**状态**: ✅ 已完成

#### 关键成果
1. ✅ **原生 API 访问**: `tableOptions` 提供完整 TanStack Table API
2. ✅ **受控状态支持**: `state` 和 `onStateChange` 外部状态管理
3. ✅ **自定义渲染**: `renderTable` 完全自定义能力
4. ✅ **使用文档**: 详细的高级用法指南

### ai-context 目录全面重构和优化
**完成时间**: 2025-06-21 19:30
**状态**: ✅ 已完成

#### 关键成果
1. ✅ **精简架构**: 从 40+ 文档精简到 8 个核心文档
2. ✅ **架构设计文档**: 添加完整的架构设计和规划
3. ✅ **开发计划文档**: 创建详细的开发路线图
4. ✅ **继续开发提示词**: 创建可复制的 AI 提示词
5. ✅ **信息密度优化**: AI 查找时间从分钟级降到秒级

## 📋 后续任务队列

### P1: 高优先级
1. **tRPC 包完善** (1-2 天)
   - 完成 tRPC 集成工具开发
   - 与 Schema 系统深度集成
   - 添加类型安全的 API 生成

2. **CRUD 包完善** (1 天)
   - 完成 CRUD 操作核心逻辑
   - 与 UI 组件集成
   - 添加权限检查集成

### P2: 中优先级
1. **测试覆盖** (2-3 天)
   - 建立测试框架
   - 添加单元测试
   - 添加集成测试

2. **插件系统** (3-5 天)
   - 完善插件加载机制
   - 实现插件间通信
   - 建立插件开发规范

### P3: 低优先级
1. **性能优化**
   - 组件性能优化
   - 构建性能优化
   - 运行时性能监控

2. **开发者体验**
   - CLI 工具优化
   - 错误提示改进
   - 开发文档完善

## 🚧 已知问题

### 需要解决
1. **CLI 启动输出**: 需要调试和优化启动时的输出问题
2. **Schema 生成**: 修复 Prisma schema 中重复字段问题
3. **类型复杂性**: 随着功能增加，类型定义变得复杂

### 技术债务
1. **测试覆盖率**: 当前测试覆盖率不足
2. **文档一致性**: 部分文档需要更新
3. **性能基准**: 缺少性能测试和基准

## 🎯 成功标准

### P0 任务完成标准
- [ ] Schema 驱动的筛选器可以自动生成并正常工作
- [ ] FormBuilder 可以基于 Schema 自动生成表单
- [ ] 所有功能都有完整的类型安全保障
- [ ] 在 linch-starter 中验证功能正常
- [ ] 文档和示例完整

### 质量标准
- [ ] 所有代码通过 TypeScript 检查
- [ ] 所有代码通过 ESLint 检查
- [ ] 所有功能有 JSDoc 文档
- [ ] 遵循统一的 i18n 架构
- [ ] 没有硬编码敏感信息

---

**维护原则**: 
- 优先级基于用户需求和项目价值
- 任务完成后立即更新状态
- 新任务添加时评估优先级
