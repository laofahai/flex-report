# 开发原则

*制定日期: 2024-12-18*

## 🎯 核心理念

Linch Kit 的开发遵循一套明确的原则，确保项目的可持续发展和高质量交付。

## 🔑 核心原则

### 1. 少重复造轮子 ⭐ **最高优先级**

#### 原则说明
在开发过程中，优先使用现有的成熟方案，避免重新发明轮子。这不仅能节省开发时间，还能利用社区的智慧和经验。

#### 具体实践
- **充分调研现有方案**：在开始开发新功能前，必须充分调研生态系统中的现有解决方案
- **优先集成而非自研**：通过适配器模式、包装器等方式集成现有优秀工具
- **谨慎评估自研需求**：只有在以下情况下才考虑自研：
  - 现有方案无法满足核心需求
  - 现有方案存在严重的性能或安全问题
  - 现有方案的许可证不兼容
  - 现有方案的维护状态堪忧

#### 成功案例
- ✅ **事务管理**：使用 Prisma Interactive Transactions + cls-hooked，而非自研 TransactionManager
- ✅ **认证系统**：基于 NextAuth.js 扩展，而非完全自研认证系统
- ✅ **UI 组件**：使用 shadcn/ui 作为基础，只自研业务特定的 CRUD 组件
- ✅ **构建工具**：使用 Turborepo + pnpm，而非自研 Monorepo 工具
- ✅ **类型验证**：使用 Zod，而非自研验证库

#### 决策流程
```
新需求 → 调研现有方案 → 评估可行性 → 选择方案
                ↓
        无合适方案 → 评估自研成本 → 决定是否自研
```

### 2. AI-First 设计

#### 原则说明
所有的设计和实现都要考虑 AI 的理解和使用便利性，为未来的 AI 辅助开发做好准备。

#### 具体实践
- **完整的类型定义**：所有接口都要有完整的 TypeScript 类型
- **清晰的接口设计**：接口命名和结构要直观易懂
- **标准化的命名约定**：遵循一致的命名规范
- **丰富的文档注释**：代码中包含详细的 JSDoc 注释

### 3. 开发效率优先

#### 原则说明
选择能够显著提升开发效率的技术和方案，减少重复劳动。

#### 具体实践
- **减少样板代码**：通过代码生成、模板等方式减少重复代码
- **自动化代码生成**：基于 Schema 自动生成相关代码
- **强类型支持**：利用 TypeScript 的类型系统提升开发体验
- **优秀的开发工具**：选择有良好工具支持的技术栈

### 4. 类型安全

#### 原则说明
通过类型系统确保代码的正确性，减少运行时错误。

#### 具体实践
- **完整的 TypeScript 支持**：所有代码都要有类型定义
- **编译时类型检查**：利用 TypeScript 编译器检查类型错误
- **运行时类型验证**：使用 Zod 等工具进行运行时验证

### 5. 灵活性优先

#### 原则说明
设计要考虑未来的扩展性和变化，避免过度设计。

#### 具体实践
- **支持多种扩展方式**：提供插件、钩子等扩展机制
- **最小化强制约束**：避免过于严格的限制
- **向后兼容性考虑**：API 变更要考虑兼容性

## 📋 决策检查清单

在做技术决策时，请参考以下检查清单：

### 技术选型检查清单
- [ ] 是否充分调研了现有方案？
- [ ] 现有方案是否能满足 80% 的需求？
- [ ] 自研的成本和风险是否可控？
- [ ] 选择的方案是否有活跃的社区支持？
- [ ] 是否考虑了 AI-First 的设计要求？
- [ ] 是否有完整的类型支持？
- [ ] 是否能提升开发效率？

### 架构设计检查清单
- [ ] 设计是否足够灵活，支持未来扩展？
- [ ] 是否遵循了单一职责原则？
- [ ] 是否考虑了性能影响？
- [ ] 是否有清晰的错误处理机制？
- [ ] 是否有完整的文档和示例？

## 🚫 反面案例

### 应该避免的做法
- ❌ **重新发明轮子**：在没有充分调研的情况下自研已有的功能
- ❌ **过度设计**：为了未来可能的需求而过度复杂化当前设计
- ❌ **忽视类型安全**：使用 `any` 类型或忽略类型错误
- ❌ **缺乏文档**：代码没有注释或文档
- ❌ **不考虑扩展性**：硬编码逻辑，难以扩展

### 历史教训
- **自研 TransactionManager**：最初考虑自研事务管理器，后来发现 Prisma + cls-hooked 已经有成熟方案
- **完全自研 UI 组件**：最初考虑完全自研 UI 组件库，后来选择基于 shadcn/ui 扩展

## 🔄 原则演进

这些原则会随着项目的发展而演进，我们会定期回顾和更新：

### 回顾周期
- **月度回顾**：检查原则的执行情况
- **季度更新**：根据实践经验更新原则
- **年度评估**：全面评估原则的有效性

### 更新机制
- 团队讨论决定原则变更
- 记录变更原因和影响
- 更新相关文档和培训材料

## 📚 相关文档

- [技术栈决策记录](../decisions/tech-stack.md)
- [插件系统架构决策](../decisions/plugin-system-architecture.md)
- [AI-First 开发最佳实践](../templates/ai-first-best-practices.md)
